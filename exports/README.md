# Exports Directory

## Overview

The `exports/` directory contains generated output files from the gematria pipeline. These JSON files provide visualization-ready data for web interfaces, analysis tools, and external integrations. All exports are generated automatically by pipeline scripts and should not be edited manually.

## Directory Contents

### Core Graph Exports

#### `graph_latest.json` - Primary Graph Data

- **Generated by**: `scripts/export_graph.py`
- **Purpose**: Complete semantic concept network for visualization
- **Contents**:
  - Nodes with IDs, labels, and metadata
  - Edges with source/target relationships and strength scores
  - Cluster assignments and community structure
  - Centrality measures (degree, betweenness, eigenvector)
- **Usage**: Primary data source for graph visualization UI

#### `graph_stats.json` - Network Statistics

- **Generated by**: `scripts/export_stats.py`
- **Purpose**: High-level network metrics and health indicators
- **Contents**:
  - Node/edge/cluster counts
  - Centrality averages and distributions
  - Edge strength analysis (strong/weak/candidate counts)
  - Network density and connectivity metrics
  - Health indicators and export metadata
- **Usage**: Dashboard cards and monitoring displays

### Phase 8 Temporal Analytics (New)

#### `temporal_patterns.json` - Time Series Patterns

- **Generated by**: `scripts/export_stats.py` (integrated)
- **Purpose**: Rolling window analysis of concept frequency across biblical texts
- **Contents**:
  - Time series data by verse/chapter indices
  - Rolling window statistics (mean, sum, variance)
  - Change point detection results
  - Series metadata (length, volatility, coverage)
- **Usage**: Temporal pattern visualization and analysis

#### `pattern_forecast.json` - Predictive Forecasting

- **Generated by**: `scripts/export_stats.py` (integrated)
- **Purpose**: Statistical forecasting models for temporal patterns
- **Contents**:
  - Forecast data for multiple horizons (10+ steps ahead)
  - Model performance metrics (RMSE, MAE)
  - Prediction intervals with confidence bands
  - Model comparison (Naive, SMA, ARIMA)
- **Usage**: Forecasting dashboard and predictive analytics

### Correlation Analysis

#### `graph_correlations.json` - Advanced Network Correlations

- **Generated by**: `scripts/export_graph.py` (with scipy dependency)
- **Purpose**: Statistical correlation analysis between network metrics
- **Contents**:
  - Cross-correlations between centrality measures
  - Significance testing and p-values
  - Correlation matrices and heatmaps data
  - Network property relationships
- **Usage**: Advanced analytics and research applications

## Data Formats

### JSON Schema Compliance

All export files follow strict JSON schemas defined in `docs/SSOT/`:

- `graph-stats.schema.json` - Statistics export format
- `graph-patterns.schema.json` - Graph topology format
- `temporal-patterns.schema.json` - Time series format
- `pattern-forecast.schema.json` - Forecasting format

### Data Types and Validation

- **Numeric Precision**: All floating-point values use appropriate precision
- **ID Consistency**: UUID-based identifiers for cross-referencing
- **Metadata Completeness**: Required fields present in all records
- **Schema Validation**: Automatic validation against SSOT schemas

## Generation Process

### Pipeline Integration

```bash
# Generate all exports after pipeline run
make exports.all

# Individual export generation
make exports.graph      # Core graph data
make exports.stats      # Statistics and Phase 8 temporal
make exports.jsonld     # Semantic web formats
```

### Automatic Triggers

- **Post-Pipeline**: Exports generated automatically after successful pipeline runs
- **Freshness Requirements**: Rule 028 requires regeneration within 24 hours
- **Dependency Checks**: Validates required database tables and views exist

### Error Handling

- **Missing Data**: Graceful degradation with fallback values
- **Schema Violations**: Validation errors logged and reported
- **Performance Issues**: Timeout protection for large dataset processing

## Usage Patterns

### Web UI Integration

```javascript
// Load graph data for visualization
const graphData = await fetch("/exports/graph_latest.json");
const stats = await fetch("/exports/graph_stats.json");

// Temporal analysis
const temporal = await fetch("/exports/temporal_patterns.json");
const forecasts = await fetch("/exports/pattern_forecast.json");
```

### API Endpoints

Dynamic API endpoints in `share/api_server.py` provide:

- `/api/v1/stats` - On-demand statistics
- `/api/v1/temporal` - Filtered temporal data
- `/api/v1/forecast` - Forecast queries

### External Integrations

- **Semantic Web**: JSON-LD and RDF/Turtle exports for knowledge graphs
- **Research Tools**: Raw data for academic analysis and visualization
- **Monitoring**: Health checks and pipeline verification

## Data Freshness and Versioning

### Timestamp Tracking

- **Export Timestamps**: ISO 8601 timestamps in all files
- **Pipeline Correlation**: Links to specific pipeline run IDs
- **Version Metadata**: Schema versions and generation parameters

### Update Frequency

- **Continuous**: Regenerated after each successful pipeline run
- **Scheduled**: Daily regeneration for monitoring data
- **On-Demand**: API endpoints for real-time queries

### Archival Policy

- **Retention**: Recent exports kept for analysis
- **Cleanup**: Automated removal of stale exports
- **Backup**: Critical exports archived for reproducibility

## Performance Considerations

### File Sizes

- **graph_latest.json**: Scales with network size (typical: 1-50MB)
- **graph_stats.json**: Small metadata file (typical: <1MB)
- **temporal_patterns.json**: Grows with time series complexity
- **pattern_forecast.json**: Compact forecast data structure

### Loading Optimization

- **Compression**: Gzip compression for network transfer
- **Streaming**: Progressive loading for large files
- **Caching**: HTTP caching headers for static files
- **CDN**: Optional CDN deployment for global access

## Security and Access

### File Permissions

- **Read Access**: Web servers need read access to export directory
- **No Write Access**: Pipeline processes only write to this directory
- **Backup Security**: Secure archival of sensitive analysis data

### Data Privacy

- **Anonymized**: No personal data in exports
- **Research Data**: Biblical text analysis only
- **Access Controls**: Appropriate permissions for different user roles

## Troubleshooting

### Common Issues

#### Missing Export Files

- **Cause**: Pipeline failure or incomplete run
- **Solution**: Check pipeline logs and re-run `make exports.all`

#### Stale Data

- **Cause**: Exports not regenerated after data updates
- **Solution**: Manual regeneration with `make exports.graph`

#### Schema Validation Errors

- **Cause**: Pipeline changes broke export format
- **Solution**: Update schemas in `docs/SSOT/` and fix pipeline

#### Large File Sizes

- **Cause**: Growing network size or detailed exports
- **Solution**: Implement pagination or compression

### Validation Commands

```bash
# Check export freshness
ls -la exports/*.json

# Validate against schemas
python scripts/verify_pr016_pr017.py --dsn "$GEMATRIA_DSN"

# Test web UI integration
make webui
```

## Maintenance

### Cleanup Procedures

```bash
# Remove old exports (keep last 7 days)
find exports -name "*.json" -mtime +7 -delete

# Compress large files
gzip exports/graph_latest.json
```

### Monitoring

- **File Sizes**: Track growth patterns
- **Generation Time**: Monitor export performance
- **Error Rates**: Log validation failures
- **Usage Patterns**: Track which exports are accessed

## Related Documentation

- **Parent**: [../README.md](../README.md) - Project overview
- **Generation Scripts**: [../scripts/AGENTS.md](../scripts/AGENTS.md) - Export pipeline docs
- **API Integration**: [../share/AGENTS.md](../share/AGENTS.md) - API endpoint specifications
- **Schemas**: [../docs/SSOT/](../docs/SSOT/) - Data format specifications
- **Visualization**: [../webui/graph/AGENTS.md](../webui/graph/AGENTS.md) - UI integration docs
