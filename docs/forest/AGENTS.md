# AGENTS.md — docs/forest/ Directory

## Directory Purpose

The `docs/forest/` directory contains the project's "forest overview" — a single, regeneratable high-level map of the entire Gemantria system. This provides stable, phase-governed orchestration for development.

## Key Components

### overview.md (Auto-generated)

**Purpose**: Human-readable snapshot of the entire system state
**Generation**: `scripts/generate_forest.py` scans:

- `.cursor/rules/*.mdc` → Active rules
- `.github/workflows/*.yml` → CI workflows
- `docs/ADRs/*.md` → Architectural decisions
  **Content Includes**:
- Current rules with descriptions
- Active CI workflows
- ADR catalog
- Last sync timestamp
  **Maintenance**: Never edit manually — regenerated by `generate_forest.py`

## Housekeeping (Rule 058)

After ANY code changes in this directory, run comprehensive housekeeping:

```bash
# Rule 058 mandatory housekeeping checklist
python3 scripts/rules_audit.py
make share.sync
python3 scripts/generate_forest.py
ruff format --check . && ruff check .
# Check if ADR needed/updated (Rule 029)
PYTHONPATH=. python3 -m pytest tests/ -v --tb=short
# Verify docs updated (AGENTS.md, SSOT, README)
```

**DO NOT SKIP ANY STEP.** See [Rule 058](../../.cursor/rules/058-auto-housekeeping.mdc) for complete checklist.


## Development Workflow

### Pre-PR Forest Check (Rule 025 Required)

```bash
# Must run before opening any new PR
make generate.forest

# Verify forest is current (< 24 hours old)
python scripts/generate_forest.py  # Check timestamp in overview.md
```

### Adding New System Components

1. **New Rules**: Create `.cursor/rules/XXX-new-rule.mdc`
2. **New CI**: Add `.github/workflows/new-workflow.yml`
3. **New ADRs**: Create `docs/ADRs/ADR-XXX-new-decision.md`
4. **Regenerate**: `make generate.forest` to update overview
5. **Verify**: Check that new components appear in overview.md

## Forest Governance (Rule 025)

### Phase Gate Enforcement

- **Trigger**: Before any PR creation/merge
- **Check**: All forest files exist and overview.md < 24h old
- **Failure**: PR blocked if forest outdated

### Forest Components Required

- `docs/forest/overview.md` (auto-generated)
- `docs/DECISION_LOG.md` (manual)
- `docs/VERIFICATION_MATRIX.md` (auto-updated)
- `scripts/generate_forest.py` (generator)

## Maintenance Guidelines

### When to Regenerate

- **Before PR**: Always regenerate forest overview
- **New Rules**: After creating new `.cursor/rules/*.mdc` files
- **New CI**: After adding `.github/workflows/*.yml`
- **New ADRs**: After creating architectural decisions
- **Weekly**: Periodic regeneration to catch drift

### Manual vs Automatic Content

- **Automatic**: `overview.md` (never edit directly)
- **Manual**: This `AGENTS.md` and `README.md` (update as needed)
- **Hybrid**: `VERIFICATION_MATRIX.md` (auto-generated skeleton, manual completion)

## Troubleshooting

### Forest Outdated

```bash
# Regenerate and check
make generate.forest
git diff docs/forest/overview.md  # Should show timestamp update
```

### Missing Components

- Check `generate_forest.py` glob patterns
- Verify file naming conventions
- Run script manually: `python scripts/generate_forest.py`

### Phase Gate Failures

- Ensure all required files exist
- Check overview.md timestamp < 24h
- Verify script execution permissions

## Cross-References

- **Parent**: `docs/AGENTS.md` (documentation directory guidance)
- **Related Rules**: Rule 025 (Phase Gate), Rule 006 (AGENTS.md Governance)
- **Related ADRs**: ADR-013 (Documentation Sync), ADR-016 (Metrics & Ontology)
- **Related Scripts**: `scripts/generate_forest.py` (forest generator)
- **Related CI**: None (forest is pre-PR gate)
