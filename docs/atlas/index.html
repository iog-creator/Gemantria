<!doctype html><html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Atlas — Knowledge MCP</title>
<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;margin:24px;line-height:1.45}
.card{border:1px solid #ddd;border-radius:12px;padding:16px;margin:12px 0}
h1{margin:0 0 8px 0} pre{background:#f6f8fa;padding:12px;border-radius:8px;overflow:auto}
.badge{display:inline-block;background:#eef;border:1px solid #ccd;border-radius:8px;padding:2px 8px;margin-left:8px;font-size:.8rem}
</style>
</head><body>
<h1>Atlas — Knowledge MCP <span class="badge">offline-safe</span></h1>
<div class="card">
  <h2>Flow Diagram</h2>
  <p>If Mermaid is available (docs/vendor/mermaid.min.js), the diagram renders below. Otherwise, open <code>docs/atlas/mcp_flow.mmd</code> directly.</p>
  <div class="mermaid">%%{init: { "theme": "default" } }%%
  %% will be replaced by mcp_flow.mmd content via fetch, if available %%
  Loading MCP flow...
  </div>
</div>

<div class="card">
  <h2>Examples & Usage</h2>
  <p>See <code>docs/ops/mcp_README.md</code> for endpoint contracts and <code>docs/atlas/mcp_examples.md</code> for psql examples.</p>
  <pre>make mcp.examples.smoke   # runs example queries; skips safely if no DSN/psql</pre>
</div>

<div class="card">
  <h2>Catalog Viewer</h2>
  <p>Open <code>mcp_catalog_view.html</code> to see the current MCP catalog JSON.</p>
  <ul><li><a href="mcp_catalog_view.html">Open viewer</a></li></ul>
</div>

<div class="card">
  <h2>Governance Search</h2>
  <p>Search Tier-0 governance docs via semantic similarity (Phase-8D).</p>
  <ul><li><a href="/governance-search" rel="external" data-external="true">Open search interface</a></li></ul>
</div>

<div class="card">
  <h2>LM Insights</h2>
  <p>Real-time monitoring of Ollama and LM Studio inference models (Phase 9).</p>
  <ul><li><a href="/lm-insights" rel="external" data-external="true">View inference models insight</a></li></ul>
</div>

<div class="card" id="mcp-proof-tile" style="display:none">
  <h2>Knowledge MCP Proof</h2>
  <div id="mcp-proof-content">Loading proof snapshot...</div>
</div>

<script>
(function(){
  function renderFlow(text){
    if (!window.mermaid){ document.querySelector('.mermaid').textContent = text; return; }
    document.querySelector('.mermaid').textContent = text;
    window.mermaid.initialize({ startOnLoad:true });
    window.mermaid.init(undefined, document.querySelectorAll('.mermaid'));
  }
  fetch('mcp_flow.mmd').then(r=>r.ok?r.text():Promise.reject()).then(renderFlow).catch(()=> {
    document.querySelector('.mermaid').textContent = 'mcp_flow.mmd (open this file in a Mermaid viewer)';
  });
})();
</script>
<script>
(function(){
  const tile = document.getElementById('mcp-proof-tile');
  const content = document.getElementById('mcp-proof-content');
  fetch('../../share/mcp/knowledge_mcp_proof.json')
    .then(r=>r.ok?r.json():Promise.reject())
    .then(data=>{
      const overallOk = data.overall_ok || false;
      const badge = overallOk ? '<span class="badge" style="background:#d4edda;border-color:#c3e6cb;color:#155724">✓ OK</span>' : '<span class="badge" style="background:#f8d7da;border-color:#f5c6cb;color:#721c24">✗ FAIL</span>';
      let html = '<h3>Proof Status ' + badge + '</h3>';
      html += '<p>Generated: ' + (data.generated_at || 'unknown') + '</p>';
      html += '<p>Components:</p><ul>';
      const comps = data.components || {};
      for(const [name, comp] of Object.entries(comps)){
        const status = comp.ok ? '✓' : '✗';
        const present = comp.present ? 'present' : 'missing';
        html += '<li>' + status + ' ' + name + ': ' + present + '</li>';
      }
      html += '</ul>';
      html += '<p><a href="../../share/mcp/knowledge_mcp_proof.json">View JSON</a> | <a href="../../share/mcp/knowledge_mcp_proof.txt">View TXT</a></p>';
      content.innerHTML = html;
      tile.style.display = 'block';
    })
    .catch(()=>{
      // File missing, hide tile gracefully
      tile.style.display = 'none';
    });
})();
</script>
<script>
/* Attempt to load local vendor mermaid if present */
(function(){
  var s=document.createElement('script'); s.src='../vendor/mermaid.min.js'; s.onload=function(){};
  s.onerror=function(){console.warn('mermaid vendor not found; leaving plain text.');};
  document.body.appendChild(s);
})();
</script>
</body></html>
