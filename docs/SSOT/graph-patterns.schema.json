{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://gemantria.ai/schemas/graph-patterns",
  "title": "Cross-Text Pattern Correlation Schema",
  "description": "JSON schema for cross-text pattern correlation analysis across multiple biblical books",
  "type": "object",
  "properties": {
    "patterns": {
      "type": "array",
      "description": "Array of cross-text pattern correlation records",
      "items": {
        "type": "object",
        "properties": {
          "book_source": {
            "type": "string",
            "description": "Source biblical book (e.g., 'Genesis', 'Exodus')",
            "minLength": 1
          },
          "book_target": {
            "type": "string",
            "description": "Target biblical book (e.g., 'Exodus', 'Leviticus')",
            "minLength": 1
          },
          "shared_concepts": {
            "type": "array",
            "description": "List of concept IDs that appear in both books",
            "items": {
              "type": "string"
            },
            "minItems": 1
          },
          "pattern_strength": {
            "type": "number",
            "description": "Overall strength of the pattern relationship (0.0 to 1.0)",
            "minimum": 0.0,
            "maximum": 1.0
          },
          "metric": {
            "type": "string",
            "description": "Pattern correlation metric used (e.g., 'jaccard', 'cosine', 'lift')",
            "enum": [
              "jaccard",
              "cosine",
              "lift",
              "support_confidence",
              "database_view"
            ]
          },
          "support": {
            "type": "number",
            "description": "Support metric: proportion of total concepts involved in pattern",
            "minimum": 0.0,
            "maximum": 1.0
          },
          "lift": {
            "type": "number",
            "description": "Lift metric: ratio of observed to expected co-occurrence",
            "minimum": 0.0
          },
          "confidence": {
            "type": "number",
            "description": "Confidence metric: conditional probability of pattern occurrence",
            "minimum": 0.0,
            "maximum": 1.0
          },
          "p_value": {
            "type": "number",
            "description": "Statistical significance p-value",
            "minimum": 0.0,
            "maximum": 1.0
          }
        },
        "required": [
          "book_source",
          "book_target",
          "shared_concepts",
          "pattern_strength",
          "metric"
        ]
      }
    },
    "metadata": {
      "type": "object",
      "description": "Metadata about the pattern analysis",
      "properties": {
        "total_patterns": {
          "type": "integer",
          "description": "Total number of cross-text patterns identified",
          "minimum": 0
        },
        "analyzed_books": {
          "type": "array",
          "description": "List of books that were analyzed for patterns",
          "items": {
            "type": "string"
          }
        },
        "pattern_methods": {
          "type": "array",
          "description": "List of pattern analysis methods used",
          "items": {
            "type": "string",
            "enum": [
              "jaccard",
              "cosine",
              "lift",
              "support_confidence",
              "database_view"
            ]
          }
        },
        "generated_at": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when analysis was performed"
        },
        "run_id": {
          "type": "string",
          "description": "Pipeline run ID that generated this analysis"
        },
        "analysis_parameters": {
          "type": "object",
          "description": "Parameters used for pattern analysis",
          "properties": {
            "min_shared_concepts": {
              "type": "integer",
              "description": "Minimum number of shared concepts to consider a pattern",
              "minimum": 1,
              "default": 2
            },
            "min_pattern_strength": {
              "type": "number",
              "description": "Minimum pattern strength threshold",
              "minimum": 0.0,
              "maximum": 1.0,
              "default": 0.1
            }
          }
        }
      },
      "required": ["total_patterns", "generated_at"]
    }
  },
  "required": ["patterns", "metadata"]
}
