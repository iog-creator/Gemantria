Makefile:982: warning: overriding recipe for target 'phase8.temporal'
Makefile:887: warning: ignoring old recipe for target 'phase8.temporal'
Makefile:1906: warning: overriding recipe for target 'rerank.smoke'
Makefile:1900: warning: ignoring old recipe for target 'rerank.smoke'
Makefile:2227: warning: overriding recipe for target 'mcp.proof.snapshot'
Makefile:2155: warning: ignoring old recipe for target 'mcp.proof.snapshot'
Makefile:2798: warning: overriding recipe for target 'governance.ingest.docs'
Makefile:291: warning: ignoring old recipe for target 'governance.ingest.docs'
>> Running reality.green - Full System Truth Gate
üîç REALITY GREEN - Full System Truth Gate
============================================================

================================================================================
LEDGER VERIFICATION SUMMARY
================================================================================
Name                                     Source                         Status    
--------------------------------------------------------------------------------
AGENTS.md                                root                           ‚úì current   
MASTER_PLAN.md                           docs/SSOT                      ‚úì current   
DB_HEALTH.md                             docs/runbooks                  ‚úì current   
PM_SNAPSHOT_CURRENT.md                   docs/runbooks                  ‚úì current   
RULES_INDEX.md                           root                           ‚úì current   
system_health.json                       share/atlas/control_plane      ‚úì current   
lm_indicator.json                        share/atlas/control_plane      ‚úì current   
canonical.json                           share/exports/docs-control     ‚úì current   
summary.json                             share/exports/docs-control     ‚úì current   
--------------------------------------------------------------------------------
Total: 9, Current: 9, Stale: 0, Missing: 0
================================================================================

‚úÖ LEDGER VERIFICATION PASSED
   All tracked artifacts are current

‚úÖ PASS: DB Health
   DB is reachable and healthy

‚úÖ PASS: Control-Plane Health
   Control plane is healthy

‚úÖ PASS: AGENTS.md Sync
   All AGENTS.md files are in sync

‚úÖ PASS: Share Sync & Exports
   All required exports present

‚úÖ PASS: Ledger Verification
   All 9 tracked artifacts are current

‚úÖ PASS: Ketiv-Primary Policy
   Ketiv-primary policy enforced (gematria uses written form per ADR-002)

‚úÖ PASS: DMS Hint Registry
   DMS hint registry accessible with 4 REQUIRED hints across 2 flow(s)

‚úÖ PASS: Repo Alignment (Layer 4)
   Plan vs implementation drift detected (HINT mode: warnings only)

‚úÖ PASS: DMS Alignment
   DMS and Share are aligned

‚úÖ PASS: Bootstrap Consistency
   Bootstrap state matches SSOT

‚ùå FAIL: Share Sync Policy
   Policy Violation: Found 70 unknown files

‚úÖ PASS: WebUI Shell Sanity
   WebUI shell files present

============================================================
‚ùå REALITY RED: One or more checks failed

System is NOT ready. Fix the issues above before:
  - Declaring a feature 'complete'
  - Opening a PR for main
  - Generating a new share/ snapshot for other agents

Run individual checks to diagnose:
  - make book.smoke              # DB health
  - python scripts/guards/guard_control_plane_health.py  # Control-plane
  - python scripts/check_agents_md_sync.py --verbose     # AGENTS.md sync
  - make share.sync              # Share sync
  - make state.verify            # Ledger verification
  - make state.sync              # Update ledger if stale

JSON Summary:
{
  "reality_green": false,
  "checks": [
    {
      "name": "DB Health",
      "passed": true,
      "message": "DB is reachable and healthy",
      "details": {
        "output": "OK: DB reachable and base tables present."
      }
    },
    {
      "name": "Control-Plane Health",
      "passed": true,
      "message": "Control plane is healthy",
      "details": {
        "output": "HINT: MV refresh failed: field name must not be null\nCONTEXT:  SQL statement \"REFRESH MATERIALIZED VIEW control.mv_compliance_30d\"\nPL/pgSQL function control.refresh_compliance(text) line 6 at SQL statement"
      }
    },
    {
      "name": "AGENTS.md Sync",
      "passed": true,
      "message": "All AGENTS.md files are in sync",
      "details": {
        "output": ""
      }
    },
    {
      "name": "Share Sync & Exports",
      "passed": true,
      "message": "All required exports present",
      "details": {}
    },
    {
      "name": "Ledger Verification",
      "passed": true,
      "message": "All 9 tracked artifacts are current",
      "details": {
        "summary": {
          "ok": true,
          "total": 9,
          "current": 9,
          "stale": [],
          "missing": [],
          "results": [
            {
              "name": "AGENTS.md",
              "source_of_truth": "root",
              "status": "current",
              "ledger_hash": "5f089e214966d282...",
              "current_hash": "5f089e214966d282..."
            },
            {
              "name": "MASTER_PLAN.md",
              "source_of_truth": "docs/SSOT",
              "status": "current",
              "ledger_hash": "7267134e5e14bb7d...",
              "current_hash": "7267134e5e14bb7d..."
            },
            {
              "name": "DB_HEALTH.md",
              "source_of_truth": "docs/runbooks",
              "status": "current",
              "ledger_hash": "7b351351aaaf7321...",
              "current_hash": "7b351351aaaf7321..."
            },
            {
              "name": "PM_SNAPSHOT_CURRENT.md",
              "source_of_truth": "docs/runbooks",
              "status": "current",
              "ledger_hash": "6c51be1d31e4250e...",
              "current_hash": "6c51be1d31e4250e..."
            },
            {
              "name": "RULES_INDEX.md",
              "source_of_truth": "root",
              "status": "current",
              "ledger_hash": "df01a6ca8e43a79b...",
              "current_hash": "df01a6ca8e43a79b..."
            },
            {
              "name": "system_health.json",
              "source_of_truth": "share/atlas/control_plane",
              "status": "current",
              "ledger_hash": "9c634ea5601204f4...",
              "current_hash": "9c634ea5601204f4..."
            },
            {
              "name": "lm_indicator.json",
              "source_of_truth": "share/atlas/control_plane",
              "status": "current",
              "ledger_hash": "0c8d7f9de6b933f5...",
              "current_hash": "0c8d7f9de6b933f5..."
            },
            {
              "name": "canonical.json",
              "source_of_truth": "share/exports/docs-control",
              "status": "current",
              "ledger_hash": "c7ca48f2888fb60a...",
              "current_hash": "c7ca48f2888fb60a..."
            },
            {
              "name": "summary.json",
              "source_of_truth": "share/exports/docs-control",
              "status": "current",
              "ledger_hash": "fd4f7625bcefe9fb...",
              "current_hash": "fd4f7625bcefe9fb..."
            }
          ]
        }
      }
    },
    {
      "name": "Ketiv-Primary Policy",
      "passed": true,
      "message": "Ketiv-primary policy enforced (gematria uses written form per ADR-002)",
      "details": {
        "output": "\u2705 Ketiv-primary guard: PASS (4399/4399 nodes)\n"
      }
    },
    {
      "name": "DMS Hint Registry",
      "passed": true,
      "message": "DMS hint registry accessible with 4 REQUIRED hints across 2 flow(s)",
      "details": {
        "total_hints": 4,
        "flows_with_hints": 2
      }
    },
    {
      "name": "Repo Alignment (Layer 4)",
      "passed": true,
      "message": "Plan vs implementation drift detected (HINT mode: warnings only)",
      "details": {
        "output": "Layer 4 Alignment Guard: FAIL\n  Expected paths: 7\n  Actual paths: 4\n  Missing: 0\n  Integration islands: 2\n\\nViolations detected:\n  - Found 2 files in scripts/code_ingest/ (plan expected scripts/governance/)\n  - Update LAYER4_CODE_INGESTION_PLAN.md or migrate code to planned locations\n\\nEvidence: evidence/repo/guard_layer4_alignment.json\n\\n\u26a0\ufe0f  HINT MODE: Warnings only (exit 0)\n",
        "note": "Run with --strict to enforce"
      }
    },
    {
      "name": "DMS Alignment",
      "passed": true,
      "message": "DMS and Share are aligned",
      "details": {
        "output": "{\n  \"ok\": true,\n  \"mode\": \"STRICT\",\n  \"dms_share_alignment\": \"OK\",\n  \"missing_in_share\": [],\n  \"missing_in_dms\": [],\n  \"extra_in_share\": []\n}"
      }
    },
    {
      "name": "Bootstrap Consistency",
      "passed": true,
      "message": "Bootstrap state matches SSOT",
      "details": {
        "output": "{\n  \"ok\": true,\n  \"mode\": \"STRICT\",\n  \"bootstrap_current_phase\": \"24\",\n  \"ssot_current_phase\": \"24\",\n  \"mismatches\": []\n}"
      }
    },
    {
      "name": "Share Sync Policy",
      "passed": false,
      "message": "Policy Violation: Found 70 unknown files",
      "details": {
        "ok": false,
        "mode": "STRICT",
        "missing_in_share": [],
        "extra_in_share": [
          "share/AGENTPM_GEMATRIA_MODULE_PLAN.md",
          "share/AGENTS.md",
          "share/BIBLESCHOLAR_INTAKE.md",
          "share/BIBLESCHOLAR_MIGRATION_PLAN.md",
          "share/DB_HEALTH.md",
          "share/GEMATRIA_NUMERICS_INTAKE.md",
          "share/GPT_REFERENCE_GUIDE.md",
          "share/GPT_SYSTEM_PROMPT.md",
          "share/LAYER3_AI_DOC_INGESTION_PLAN.md",
          "share/LAYER4_CODE_INGESTION_PLAN.md",
          "share/LM_STUDIO_SETUP.md",
          "share/LM_WIDGETS.md",
          "share/MASTER_PLAN.md",
          "share/NEXT_STEPS.md",
          "share/PHASE16_AUDIT_SNAPSHOT.json",
          "share/PHASE16_CLASSIFICATION_REPORT.json",
          "share/PHASE16_DB_RECON_REPORT.json",
          "share/PHASE16_PURGE_EXECUTION_LOG.json",
          "share/PHASE18_AGENTS_SYNC_SUMMARY.json",
          "share/PHASE18_INDEX.md",
          "share/PHASE18_LEDGER_REPAIR_SUMMARY.json",
          "share/PHASE18_SHARE_EXPORTS_SUMMARY.json",
          "share/PHASE19_SHARE_HYGIENE_SUMMARY.json",
          "share/PHASE20_INDEX.md",
          "share/PHASE20_ORCHESTRATOR_UI_MODEL.md",
          "share/PHASE20_UI_RESET_DECISION.md",
          "share/PHASE21_CONSOLE_SERVE_PLAN.md",
          "share/PHASE21_INDEX.md",
          "share/PHASE22_INDEX.md",
          "share/PHASE22_OPERATOR_WORKFLOW.md",
          "share/PHASE23_AGENTS_SYNC_REPAIR_SUMMARY.json",
          "share/PHASE23_BASELINE_NOTE.md",
          "share/PHASE23_BOOTSTRAP_HARDENING_NOTE.md",
          "share/PHASE23_FAILURE_INJECTION_NOTE.md",
          "share/PHASE23_INDEX.md",
          "share/PHASE23_PHASE_DONE_CHECKLIST.md",
          "share/PHASE23_STRESS_PLAN.md",
          "share/PHASE23_STRESS_SMOKE_NOTE.md",
          "share/PHASE_14_SEMANTIC_RECORD.md",
          "share/PHASE_6_PLAN.md",
          "share/PM_BOOTSTRAP_STATE.json",
          "share/PM_CONTRACT.md",
          "share/PM_CONTRACT_STRICT_SSOT_DMS.md",
          "share/PM_HANDOFF_PROTOCOL.md",
          "share/PROJECTS_INVENTORY.md",
          "share/REFERENCES.md",
          "share/RULES_INDEX.md",
          "share/SHARE_FOLDER_ANALYSIS.md",
          "share/SSOT_SURFACE_V17.json",
          "share/STORYMAKER_INTAKE.md",
          "share/USAGE_PATTERNS_REFERENCE.md",
          "share/atlas/control_plane/lm_indicator.json",
          "share/atlas/control_plane/system_health.json",
          "share/exports/docs-control/canonical.json",
          "share/exports/docs-control/summary.json",
          "share/kb_registry.json",
          "share/orchestrator/ACTIVE_PROMPTS.md",
          "share/orchestrator/CONSOLE_SCHEMA.json",
          "share/orchestrator/DECISION_LOG.json",
          "share/orchestrator/NOTES.md",
          "share/orchestrator/RESEARCH_INDEX.md",
          "share/orchestrator/STATE.json",
          "share/orchestrator/VIEW_MODEL.json",
          "share/orchestrator_assistant/ACTIVE_PROMPTS.md",
          "share/orchestrator_assistant/DECISION_LOG.json",
          "share/orchestrator_assistant/NOTES.md",
          "share/orchestrator_assistant/RESEARCH_INDEX.md",
          "share/orchestrator_assistant/STATE.json",
          "share/scripts_AGENTS.md",
          "share/webui-contract.md"
        ],
        "missing_in_dms": [
          "share/AGENTPM_GEMATRIA_MODULE_PLAN.md",
          "share/AGENTS.md",
          "share/BIBLESCHOLAR_INTAKE.md",
          "share/BIBLESCHOLAR_MIGRATION_PLAN.md",
          "share/DB_HEALTH.md",
          "share/GEMATRIA_NUMERICS_INTAKE.md",
          "share/GPT_REFERENCE_GUIDE.md",
          "share/GPT_SYSTEM_PROMPT.md",
          "share/LAYER3_AI_DOC_INGESTION_PLAN.md",
          "share/LAYER4_CODE_INGESTION_PLAN.md",
          "share/LM_STUDIO_SETUP.md",
          "share/LM_WIDGETS.md",
          "share/MASTER_PLAN.md",
          "share/NEXT_STEPS.md",
          "share/PHASE16_AUDIT_SNAPSHOT.json",
          "share/PHASE16_CLASSIFICATION_REPORT.json",
          "share/PHASE16_DB_RECON_REPORT.json",
          "share/PHASE16_PURGE_EXECUTION_LOG.json",
          "share/PHASE18_AGENTS_SYNC_SUMMARY.json",
          "share/PHASE18_INDEX.md",
          "share/PHASE18_LEDGER_REPAIR_SUMMARY.json",
          "share/PHASE18_SHARE_EXPORTS_SUMMARY.json",
          "share/PHASE19_SHARE_HYGIENE_SUMMARY.json",
          "share/PHASE20_INDEX.md",
          "share/PHASE20_ORCHESTRATOR_UI_MODEL.md",
          "share/PHASE20_UI_RESET_DECISION.md",
          "share/PHASE21_CONSOLE_SERVE_PLAN.md",
          "share/PHASE21_INDEX.md",
          "share/PHASE22_INDEX.md",
          "share/PHASE22_OPERATOR_WORKFLOW.md",
          "share/PHASE23_AGENTS_SYNC_REPAIR_SUMMARY.json",
          "share/PHASE23_BASELINE_NOTE.md",
          "share/PHASE23_BOOTSTRAP_HARDENING_NOTE.md",
          "share/PHASE23_FAILURE_INJECTION_NOTE.md",
          "share/PHASE23_INDEX.md",
          "share/PHASE23_PHASE_DONE_CHECKLIST.md",
          "share/PHASE23_STRESS_PLAN.md",
          "share/PHASE23_STRESS_SMOKE_NOTE.md",
          "share/PHASE_14_SEMANTIC_RECORD.md",
          "share/PHASE_6_PLAN.md",
          "share/PM_BOOTSTRAP_STATE.json",
          "share/PM_CONTRACT.md",
          "share/PM_CONTRACT_STRICT_SSOT_DMS.md",
          "share/PM_HANDOFF_PROTOCOL.md",
          "share/PROJECTS_INVENTORY.md",
          "share/REFERENCES.md",
          "share/RULES_INDEX.md",
          "share/SHARE_FOLDER_ANALYSIS.md",
          "share/SSOT_SURFACE_V17.json",
          "share/STORYMAKER_INTAKE.md",
          "share/USAGE_PATTERNS_REFERENCE.md",
          "share/atlas/control_plane/lm_indicator.json",
          "share/atlas/control_plane/system_health.json",
          "share/exports/docs-control/canonical.json",
          "share/exports/docs-control/summary.json",
          "share/kb_registry.json",
          "share/orchestrator/ACTIVE_PROMPTS.md",
          "share/orchestrator/CONSOLE_SCHEMA.json",
          "share/orchestrator/DECISION_LOG.json",
          "share/orchestrator/NOTES.md",
          "share/orchestrator/RESEARCH_INDEX.md",
          "share/orchestrator/STATE.json",
          "share/orchestrator/VIEW_MODEL.json",
          "share/orchestrator_assistant/ACTIVE_PROMPTS.md",
          "share/orchestrator_assistant/DECISION_LOG.json",
          "share/orchestrator_assistant/NOTES.md",
          "share/orchestrator_assistant/RESEARCH_INDEX.md",
          "share/orchestrator_assistant/STATE.json",
          "share/scripts_AGENTS.md",
          "share/webui-contract.md"
        ]
      }
    },
    {
      "name": "WebUI Shell Sanity",
      "passed": true,
      "message": "WebUI shell files present",
      "details": {}
    }
  ],
  "timestamp": "2025-12-06T04:49:58Z"
}
make: *** [Makefile:598: reality.green] Error 1
