---
description: Non-negotiable rules for Gemantria
alwaysApply: true
---

- Code gematria > bible_db > LLM (LLM metadata only).
- bible_db is READ-ONLY; any write attempt must error.
- No mock datasets or __mocks__ folders. Tests are code-verified or DB-derived only.
- Normalize Hebrew: NFKD→strip combining→strip maqaf (U+05BE)/sof pasuq (U+05C3)/punct→NFC.
- Finals=regular (Mispar Hechrachi). Compute gematria on surface form; keep calc strings.
- Identity: content_hash (SHA-256) as deterministic ID; uuidv7 as a sortable surrogate.
- Batches: 50 nouns by default; if <50, abort and write review.ndjson. `ALLOW_PARTIAL=1` must be explicit and recorded in the run manifest.
- Network: default relation `shared_prime` with per-noun cap k=3; optional `identical_value`, `gcd_gt_1` via flags.
- Schema/algorithm changes require ADR + tests (+ migrations if DB) in the same PR.