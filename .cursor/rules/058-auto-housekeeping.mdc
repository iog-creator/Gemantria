---
description: Mandatory run rules_audit.py/share.sync/forest regen after every change/PR. Fail-closed if skipped—critical error log/CI fail.
globs:
  - "src/**"
  - "scripts/**"
  - "migrations/**"
  - "webui/**"
  - "docs/**"
  - "AGENTS.md"
  - ".cursor/rules/**"
alwaysApply: false
---

# Rule 058 — Auto-Housekeeping Post-Change (AlwaysApply)

Mandatory run `rules_audit.py`/`share.sync`/`forest regen` after every change/PR. Fail-closed if skipped—critical error log/CI fail.

## Requirements

**MANDATORY EXECUTION**: After ANY codebase change (code/docs/rules), developers MUST run housekeeping commands:

```bash
# Rule compliance audit
python3 scripts/rules_audit.py

# Documentation synchronization  
make share.sync

# Forest overview regeneration
python3 scripts/generate_forest.py
```

**FAIL-CLOSED DESIGN**: If housekeeping skipped, operations fail with critical error logs:
```
CRITICAL: Housekeeping not run after changes - failing per Rule 058
Evidence: Modified files detected without housekeeping completion
```

## Integration Points

### CI/CD Enforcement
- **Pre-commit hooks**: Block commits without housekeeping completion
- **PR checks**: Require housekeeping evidence in PR descriptions  
- **Branch protection**: Enforce housekeeping completion for merges

### Development Workflow
- **IDE integration**: Automatic housekeeping prompts after saves
- **Git hooks**: Pre-commit validation of housekeeping status
- **Status indicators**: Clear visual feedback on housekeeping state

## Related Rules

- **Rule 027**: Docs sync gate (housekeeping includes docs sync)
- **Rule 055**: Auto-docs sync pass (housekeeping enforces this)
- **Rule 017**: Agent docs presence (housekeeping validates coverage)