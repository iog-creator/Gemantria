repos:
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.6.9
    hooks:
      - id: ruff
        args: ["--config","pyproject.toml"]
      - id: ruff-format
        args: ["--config","pyproject.toml"]
  - repo: local
    hooks:
      - id: agents_md_lint
        name: agents.md lint (root no-bloat)
        entry: scripts/guards/agents_md_lint.sh
        language: system
        pass_filenames: false
        stages: [commit]
      - id: guard-python-runner
        name: guard-python-runner
        entry: bash scripts/guards/guard_python_runner.sh
        language: system
        pass_filenames: false
      - id: share-sync-hook
        name: share sync (auto-sync tracked files)
        entry: bash scripts/guards/share_sync_hook.sh
        language: system
        pass_filenames: false
        stages: [commit]
        files: |
          (?x)^(
            MASTER_PLAN\.md|
            docs/SSOT/MASTER_PLAN\.md|
            RULES_INDEX\.md|
            docs/SSOT/RULES_INDEX\.md|
            AGENTS\.md|
            README_FULL\.md|
            README\.md|
            docs/SSOT/GPT_SYSTEM_PROMPT\.md|
            docs/runbooks/LM_STUDIO_SETUP\.md|
            docs/runbooks/DB_HEALTH\.md|
            docs/SSOT/webui-contract\.md|
            docs/SSOT/SHARE_MANIFEST\.json
          )$
      - id: agents-md-sync-check
        name: AGENTS.md sync check (fail-closed)
        entry: bash -c 'cd "$(git rev-parse --show-toplevel)" && PYTHONPATH=. python scripts/check_agents_md_sync.py --staged'
        language: system
        pass_filenames: false
        stages: [commit]
        files: |
          (?x)^(
            .*\.py$|
            .*AGENTS\.md$|
            src/.*|
            agentpm/.*|
            webui/.*|
            scripts/.*|
            tests/.*|
            docs/.*
          )$
